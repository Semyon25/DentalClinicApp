<Window x:Class="DentalClinicApp.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DentalClinicApp"
        xmlns:viewModels="clr-namespace:DentalClinicApp.ViewModels"
        xmlns:utils="clr-namespace:DentalClinicApp.Utils"
        mc:Ignorable="d"
        Title="Стоматология" Height="450" Width="800">
    <Window.Resources>
        <utils:NullToBoolConverter x:Key="NullToBoolConverter"/>
    </Window.Resources>
    <DockPanel>
        <!-- Toolbar -->
        <ToolBar DockPanel.Dock="Top" ToolBarTray.IsLocked="True" >
            <Button Command="{Binding AddPatientCommand}" > 
                <StackPanel Orientation="Horizontal">
                    <Viewbox Width="16" Height="16">
                        <Canvas Width="24" Height="24">
                            <Path Data="M12,5 L12,19 M5,12 L19,12" Stroke="Green" StrokeThickness="3" StrokeStartLineCap="Round" StrokeEndLineCap="Round"/>
                        </Canvas>
                    </Viewbox>
                    <TextBlock Text="Добавить пациента" />
                </StackPanel>
                <Button.ToolTip>
                    <ToolTip Content="Добавить нового пациента в список"/>
                </Button.ToolTip>
            </Button>
            <Button Command="{Binding AddPhotoCommand}" HorizontalAlignment="Right" IsEnabled="{Binding SelectedPatient, Converter={StaticResource NullToBoolConverter}}">
                <StackPanel Orientation="Horizontal">
                    <Viewbox Width="16" Height="16" Margin="0,0,2,0">
                        <Canvas Width="24" Height="24">
                            <!-- Рамка -->
                            <Rectangle Width="18" Height="14" Stroke="Green" StrokeThickness="2" RadiusX="2" RadiusY="2" Canvas.Left="3" Canvas.Top="5"/>
                            <!-- Плюсик -->
                            <Path Data="M12 8 L12 16 M8 12 L16 12" Stroke="Green" StrokeThickness="2" StrokeStartLineCap="Round" StrokeEndLineCap="Round"/>
                        </Canvas>
                    </Viewbox>
                    <TextBlock Text="Добавить фото" />
                </StackPanel>
                <Button.ToolTip>
                    <ToolTip Content="Добавить фото пациента"/>
                </Button.ToolTip>
            </Button>
        </ToolBar>
    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="3*"/>
        </Grid.ColumnDefinitions>

        <DockPanel Grid.Column="0" Margin="5">
                <TextBlock DockPanel.Dock="Top" Text="Список пациентов" FontWeight="Bold" FontSize="16" Margin="0,0,0,10"/>

            <ListBox ItemsSource="{Binding Patients}"
                     SelectedItem="{Binding SelectedPatient, Mode=TwoWay}"
                     DisplayMemberPath="FullName" />
        </DockPanel>

        <DockPanel Grid.Column="1" Margin="10" AllowDrop="True" DragOver="PhotoDropZone_DragEnter" Drop="PhotoDropZone_Drop">
            <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="0 0 0 10">
                    <TextBlock Text="{Binding SelectedPatient.FullName}" FontSize="18" VerticalAlignment="Center" Margin="0 0 10 0"/>
            </StackPanel>

            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <ItemsControl ItemsSource="{Binding Photos}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border BorderBrush="Gray" BorderThickness="1" Margin="5" Padding="5">
                                <StackPanel>
                                    <Image Source="{Binding FilePath}" Height="150" Stretch="Uniform" />
                                    <TextBlock Text="{Binding UploadedAt}" FontSize="12" Foreground="Gray" />
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </ScrollViewer>
        </DockPanel>


        </Grid>
    </DockPanel>
</Window>
